# Tasks: Enhance Wallet Management

- [x] **Spec**: Finalize Exchange and Transaction capabilities logic
- [x] **Backend**: Implement `wallet.exchange` mutation
  - [x] Create Zod schema for exchange input
  - [x] Implement transactional update logic in `wallet.router.ts`
  - [x] Add unit tests for insufficient funds and zero amounts
- [x] **Frontend**: ~~Create `TransactionModalComponent`~~ (Kept)
  - [x] Scaffold component with Inputs: `mode` ('deposit' | 'withdraw' | 'update'), `currency`, `currentBalance`
  - [x] Implement UI with amount input and validation
  - [x] Connect "Confirm" action to `trpc.wallet.updateBalance` or `trpc.wallet.adjustBalance`
- [x] **Frontend**: ~~Create `ExchangeModalComponent`~~ (Removed)
  - [x] Scaffold component with Inputs: `balances`, `exchangeRates`
  - [x] Implement "From" and "To" currency selection logic (prevent same currency)
  - [x] Implement Rate input (default to market rate, editable)
  - [x] Implement "You Pay" / "You Receive" calculation logic
  - [x] Connect "Exchange" action to `trpc.wallet.exchange`
- [x] **Frontend**: Integrate into `WalletPage`
  - [x] Add `TransactionModalComponent` to template
  - [x] ~~Add `ExchangeModalComponent` to template~~ (Removed)
  - [x] ~~Wire up "Deposit", "Withdraw", and "Exchange" buttons to open respective modals~~ (Removed)
  - [x] Wire up "Update" (pencil icon) buttons on balance cards to open Transaction Modal in 'update' mode
- [x] **Cleanup**: Remove `openUpdateModal` method and native `prompt` calls
- [x] **Verification**: Manual Test
  - [x] Verify Deposit increases balance
  - [x] Verify Withdraw decreases balance and blocks overdraft
  - [x] Verify Exchange updates both currencies correctly using custom rate
- [x] **Refactor**: Remove Quick Actions & Exchange (Requested by User)
  - [x] Remove `ExchangeModalComponent`
  - [x] Remove Quick Actions UI
  - [x] Simplify `WalletPage` logic
